import{r,a as ee,o as s,b as o,e,t as u,u as t,F as C,f as I,h as c,i as te,j as B,w as le,k as f,v as _,l as L,m as X,c as ne,p as R,q as ae,s as se}from"./entry.d8bcef15.js";import{b as K,_ as oe}from"./bns.24e95b72.js";import{A as re,_ as ie}from"./ardb.bec4bd6a.js";const ue={class:"flex flex-col"},de={class:"text-xs text-center w-full flex mb-1"},ce={class:"menu bg-base-100 flex flex-col menu-horizontal"},me={class:"min-w-[6rem]"},pe={key:0,class:"bg-base-100 min-w-[6rem]"},ve={key:0},fe=["onClick"],_e={__name:"Selector",props:["variants","selectedVariantKey","label"],emits:["update:selected"],setup(E,{expose:g,emit:S}){const b=E,i=r(b.variants),m=r(null),y=r(!0),v=r(b.selectedVariantKey);let U=ee(()=>b.variants.find(p=>p.key==v.value));function x(p){v.value=p,m.value.blur(),y.value=!1,te(()=>{setTimeout(()=>{y.value=!0},100)}),S("update:selected",v)}return g({select:x}),(p,$)=>(s(),o("div",ue,[e("label",de,u(b.label),1),e("ul",ce,[e("li",{tabindex:"0",class:"focus:",ref_key:"selectorRoot",ref:m},[e("span",me,u(t(U).name),1),t(y)?(s(),o("ul",pe,[(s(!0),o(C,null,I(t(i),h=>(s(),o(C,{key:h.key},[h.key!=t(v)?(s(),o("li",ve,[e("a",{onClick:k=>x(h.key)},u(h.name),9,fe)])):c("",!0)],64))),128))])):c("",!0)],512)])]))}};const xe={key:0,class:"h-full w-full flex flex-col items-center justify-center"},we=e("h1",{class:"text-2xl mt-4"},"Create new Arweave-Nameserver record",-1),ye={class:"bg-neutral md:w-2/3 lg:w-2/3 xl:w-3/4 2xl:w-1/2 w-full p-4 mt-4 flex flex-col items-center justify-center"},he=e("p",{class:"text-lg mb-2"},"Provide name",-1),ge={class:"flex flex-col w-full md:w-max overflow-x-auto justify-center items-stretch"},be=e("p",{class:"text-lg mt-3 w-full text-center mb-4"},"Add name managers",-1),ke={class:"bg-base-100 p-2 flex flex-row justify-between items-center border-b border-b-base-content"},Te=["onClick"],Ae=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),Ne=[Ae],Ce={class:"bg-base-100 p-0 flex flex-row justify-between items-center"},Se=e("p",{class:"text-lg mt-3"},"Set initial DNS",-1),Ve={key:0,class:"overflow-x-auto w-full md:w-3/4"},Me={class:"table w-full table-compact"},Re=e("thead",null,[e("tr",null,[e("th",null,"Type"),e("th",null,"Name"),e("th",null,"Content"),e("th",null,"TTL"),e("th")])],-1),Ue={key:0,class:"badge ml-2 text-xs badge-outline"},$e=["onClick"],je=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),Be=[je],Le={class:"w-full mt-2 flex flex-row items-end justify-center flex-wrap"},Xe={key:2,class:"h-full w-full flex flex-col items-center justify-center"},Ie=e("div",{class:"text-3xl text-center"},"Congratulations! Recorded to Arweave!",-1),Ee={class:"text-lg text-center m-2"},De={class:"inline-flex bg-neutral rounded-md px-2"},Ke={class:"overflow-x-auto w-max"},Pe={class:"table w-full table-zebra"},ze=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Record")])],-1),Fe=e("th",null,"NS1",-1),Oe=e("th",null,"NS2",-1),We={__name:"create",async setup(E){let g,S;const b=B("arweave",()=>{re.init({host:"arweave.net",port:443,protocol:"https",timeout:6e4,logging:!1})}),i=r({address:"",mx:"",priority:10,ns:"",target:"",txt:""}),m=r("A"),y=r(""),v=r(""),U=r(""),x=r([]),p=r(""),$=r(null),h=r(null),k=r(0),T=r(""),D=r(300),P=r([{key:60,name:"1 Min"},{key:300,name:"5 min"},{key:1800,name:"30 min"},{key:3600,name:"1 hour"},{key:21600,name:"6 hours"},{key:86400,name:"24 hours"}]),z=r([{key:"A",name:"A"},{key:"TXT",name:"TXT"},{key:"CNAME",name:"CNAME"},{key:"AAAA",name:"AAAA"},{key:"MX",name:"MX"},{key:"NS",name:"NS"}]),V=b.value,F=B("ardb",()=>new ie(V.value));let j=B("wallet",()=>null).value;F.value;const A=r([([g,S]=le(()=>j.getActiveAddress()),g=await g,S(),g)]);function O(a){m.value=a.value}function Z(a){D.value=a.value}function J(){let a={name:v.value,ttl:D.value,data:i.value,type:m.value};!a.name.endsWith(".@")&&a.name!=""&&a.name!="@"&&(a.name+=".@"),a.name==""&&(a.name="@"),v.value="",U.value="",h.value.select(300),$.value.select("A"),i.value={address:"",mx:"",priority:10,ns:"",txt:"",target:""},x.value.push(a)}function q(a){x.value=x.value.filter((n,w)=>w!=a)}async function H(){k.value=1;let a=K.wire.toZone(x.value.map(d=>(d.data.txt=[d.data.txt],d.data.priority=parseInt(d.data.priority),new K.wire.Record().fromJSON({name:d.name.split("@").join(T.value)+".",ttl:d.ttl||300,data:d.data,type:d.type,class:"IN"})))),n=await V.createTransaction({data:a});n.addTag("Content-Type","text/dns-zone");let{id:w}=await j.dispatch(n),N=await V.createTransaction({data:JSON.stringify({managers:A.value,recordsTx:w})});A.value.forEach(d=>N.addTag("Manager",d)),N.addTag("App-Name","Arweave-Nameserver"),N.addTag("Domain-Name",T.value);let{id:M}=await j.dispatch(N),l="Not found.";for(;l=="Not found.";)l=await fetch(`https://arweave.net/${M}`).then(d=>d.text()),Q(3e3);y.value=BigInt("0x"+Y(V.utils.b64UrlToBuffer(M))).toString(36),k.value=2}function W(a){A.value=A.value.filter(n=>n!=a)}function G(){p.value!=""&&(A.value.push(p.value),p.value="")}function Q(a){return new Promise(n=>setTimeout(n,a))}function Y(a){return a.reduce((n,w)=>n+w.toString(16).padStart(2,"0"),"")}return(a,n)=>{const w=_e,N=oe,M=se;return s(),o(C,null,[t(k)==0?(s(),o("div",xe,[we,e("div",ye,[he,f(e("input",{class:"input w-full xl:w-1/3",placeholder:"e.g mouse.stars","onUpdate:modelValue":n[0]||(n[0]=l=>L(T)?T.value=l:null)},null,512),[[_,t(T)]]),e("div",ge,[be,(s(!0),o(C,null,I(t(A),l=>(s(),o("div",ke,[R(u(l)+" ",1),e("div",{class:"inline-flex cursor-pointer ml-4",onClick:d=>W(l)},Ne,8,Te)]))),256)),e("div",Ce,[f(e("input",{class:"input py-0 px-2 h-10 w-full focus:outline-none",placeholder:"Arweave address of new manager","onUpdate:modelValue":n[1]||(n[1]=l=>L(p)?p.value=l:null)},null,512),[[_,t(p)]]),e("button",{class:"btn btn-sm mr-1",onClick:G},"Add")])]),Se,t(x).length>0?(s(),o("div",Ve,[e("table",Me,[Re,e("tbody",null,[(s(!0),o(C,null,I(t(x),(l,d)=>(s(),o("tr",null,[e("th",null,u(l.type),1),e("td",null,u(l.name),1),e("td",null,[R(u(l.data.address)+u(l.data.mx)+u(l.data.txt)+" "+u(l.data.target)+" "+u(l.data.ns)+" ",1),l.type=="MX"?(s(),o("div",Ue,u(l.data.priority),1)):c("",!0)]),e("td",null,u(l.ttl),1),e("td",null,[e("div",{class:"inline-flex cursor-pointer",onClick:Ze=>q(d)},Be,8,$e)])]))),256))])])])):c("",!0),e("div",Le,[X(w,{"onUpdate:selected":O,variants:t(z),ref_key:"typeSelector",ref:$,selectedVariantKey:"A",label:"Record type"},null,8,["variants"]),f(e("input",{class:"input ml-2",placeholder:"Record name (@ for root)","onUpdate:modelValue":n[2]||(n[2]=l=>L(v)?v.value=l:null)},null,512),[[_,t(v)]]),t(m)=="A"?f((s(),o("input",{key:0,class:"input ml-2","onUpdate:modelValue":n[3]||(n[3]=l=>t(i).address=l),placeholder:"Record IPv4"},null,512)),[[_,t(i).address]]):c("",!0),t(m)=="AAAA"?f((s(),o("input",{key:1,class:"input ml-2","onUpdate:modelValue":n[4]||(n[4]=l=>t(i).address=l),placeholder:"Record IPv6"},null,512)),[[_,t(i).address]]):c("",!0),t(m)=="NS"?f((s(),o("input",{key:2,class:"input ml-2","onUpdate:modelValue":n[5]||(n[5]=l=>t(i).ns=l),placeholder:"Nameserver Address"},null,512)),[[_,t(i).ns]]):c("",!0),t(m)=="CNAME"?f((s(),o("input",{key:3,class:"input ml-2","onUpdate:modelValue":n[6]||(n[6]=l=>t(i).target=l),placeholder:"CNAME Target"},null,512)),[[_,t(i).target]]):c("",!0),t(m)=="MX"?f((s(),o("input",{key:4,class:"input ml-2","onUpdate:modelValue":n[7]||(n[7]=l=>t(i).mx=l),placeholder:"Target"},null,512)),[[_,t(i).mx]]):c("",!0),t(m)=="MX"?f((s(),o("input",{key:5,class:"input ml-2","onUpdate:modelValue":n[8]||(n[8]=l=>t(i).priority=l),type:"number",max:"100",min:"0",step:"1",placeholder:"Priority"},null,512)),[[_,t(i).priority]]):c("",!0),t(m)=="TXT"?f((s(),o("input",{key:6,class:"input ml-2","onUpdate:modelValue":n[9]||(n[9]=l=>t(i).txt=l),placeholder:"Text Content"},null,512)),[[_,t(i).txt]]):c("",!0),X(w,{"onUpdate:selected":Z,variants:t(P),label:"Time to live",class:"ml-2",ref_key:"ttlSelector",ref:h,selectedVariantKey:300},null,8,["variants"]),e("button",{class:"btn btn-outline ml-2 mt-2",onClick:J},"Add record")]),e("button",{class:"btn btn-primary btn-lg px-8 mt-4 min-h-0 h-auto py-4",onClick:H},"Save")])])):c("",!0),t(k)==1?(s(),ne(N,{key:1})):t(k)==2?(s(),o("div",Xe,[Ie,e("div",Ee,[R("Now, assign these nameservers to "),e("p",De,u(t(T)),1)]),e("div",Ke,[e("table",Pe,[ze,e("tbody",null,[e("tr",null,[Fe,e("td",null,u(t(y))+".winston",1)]),e("tr",null,[Oe,e("td",null,u(t(y))+"._arweave",1)])])]),X(M,{class:"btn btn-outline flex mt-4",to:"/"},{default:ae(()=>[R("Back to management panel")]),_:1})])])):c("",!0)],64)}}};export{We as default};
